<div class="fixed-links">
  <span class="label" style="margin-right: 800px;"></span>
  <select id="feature-select-relation" class="feature-select" onchange="jumpToFeature(this)">
    <option value="">Select a feature...</option>
    {% for column_name in context.relation_info.keys() %}
      <option value="#{{ column_name }}_relations">{{ column_name }}</option>
    {% endfor %}
  </select>
</div>

<script>
  function jumpToFeature(select) {
    if (select.value) {
      location.hash = select.value;
      // Reset to placeholder after short delay to ensure hash works
      setTimeout(() => {
        select.value = "";
      }, 100);
    }
  }
</script>
{% if context.num_feats != 0 %}
<h3>Note: {{ context.num_feats }} features have been analyzed for relations, others might have too many missing values or there are simply too much features.</h3>
{% endif %}

<span id = "correlation-plot"><br></span>
<h3>Correlation plot</h3>

<div style="display: flex; flex-direction: column; align-items: center;">
  <div style="width: 100%; max-width: 800px;" class="anchor-offset">
    {{ context.plot1 | safe }}
  </div>
  <br>
</div>
<div style="clear: both;"></div>
<span id = "mi-plot"><br></span>
<h3>Mutual information plot</h3>
<div style="display: flex; flex-direction: column; align-items: center;">
  <div style="width: 100%; max-width: 800px;" class="anchor-offset">
    {{ context.plot2 | safe }}
  </div>
</div>

<div style="clear: both;"></div>
<span id = "rel-per-feature"><br></span>
<h3>Relations per feature</h3>
{% for column_name, stats in context.relation_info.items() %}
  <span id="{{ column_name }}_relations"><br></span>
  <h3>{{ column_name }}</h3>
  
  <table class="feature-summary">
    <tbody>
      {% for key, value in stats.items() %}
        <tr>
          <th>{{ key.replace('_', ' ').capitalize() }}</th>
          <td>{{ value }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endfor %}

