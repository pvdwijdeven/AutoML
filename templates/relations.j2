<div class="fixed-links">
  <span class="label" style="margin-right: 20px;">Relations </span>
  <a href="#correlation-plot">Correlation</a> |  
  <a href="#mi-plot">Mutual information</a>
  <select id="feature-select-relation" class="feature-select" onchange="jumpToFeature(this)">
    <option value="">Select a feature...</option>
    {% for column_name in context.relation_info.keys() %}
      <option value="#{{ column_name }}_relations">{{ column_name }}</option>
    {% endfor %}
  </select>
</div>

<script>
  function jumpToFeature(select) {
    if (select.value) {
      location.hash = select.value;
      // Reset to placeholder after short delay to ensure hash works
      setTimeout(() => {
        select.value = "";
      }, 100);
    }
  }
</script>
{% if context.num_feats != 0 %}
<h3>Note: {{ context.num_feats }} features have been analyzed for relations, others have too many missing values.</h3>
{% endif %}
<div style="display: flex; flex-direction: column; align-items: center;">
  <div id="correlation-plot" style="width: 100%; max-width: 800px;" class="anchor-offset">
    {{ context.plot1 | safe }}
  </div>
  <div id="mi-plot" style="width: 100%; max-width: 800px;" class="anchor-offset">
    {{ context.plot2 | safe }}
  </div>
</div>

    <div style="clear: both;"></div>

{% for column_name, stats in context.relation_info.items() %}
  <h3 id="{{ column_name }}_relations" class="anchor-offset">{{ column_name }}</h3>
  
  <table class="feature-summary">
    <tbody>
      {% for key, value in stats.items() %}
        <tr>
          <th>{{ key.replace('_', ' ').capitalize() }}</th>
          <td>{{ value }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endfor %}

